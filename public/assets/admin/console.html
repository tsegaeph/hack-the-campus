<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin Console</title>
  <style>
    /* (styles omitted for brevity — keep your existing styles) */
    :root{
      --bg:#061016; --panel:#07131a; --accent:#2bd4c6; --danger:#ff5b5b; --muted:#9fb7b3; --white:#e9fbf7;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#041018 0%, #061016 100%);font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;color:var(--white);-webkit-font-smoothing:antialiased}
    .wrap{max-width:1100px;margin:28px auto;padding:20px}
    .header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:10px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:48px;height:48px;border-radius:8px;background:linear-gradient(135deg,var(--accent),#48a6ff);display:flex;align-items:center;justify-content:center;font-weight:800;color:#021017}
    h1{margin:0;font-size:20px}
    .sub{color:var(--muted);font-size:13px}
    .panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:16px;border-radius:10px;border:1px solid rgba(255,255,255,0.02);box-shadow:0 20px 60px rgba(0,0,0,0.6)}
    .cards{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));border-radius:10px;padding:18px;min-height:110px;display:flex;flex-direction:column;justify-content:space-between;border:1px solid rgba(255,255,255,0.02);cursor:pointer;transition:transform 160ms ease, box-shadow 160ms ease;}
    .card:hover{transform:translateY(-6px);box-shadow:0 18px 48px rgba(0,0,0,0.6)}
    .card .title{font-weight:700;font-size:14px;color:var(--white)}
    .card .desc{font-size:13px;color:var(--muted);margin-top:8px}
    .card .cta{display:flex;align-items:center;justify-content:flex-end;margin-top:12px}
    .card .badge{background:rgba(255,255,255,0.02);padding:6px 8px;border-radius:6px;font-size:12px;color:var(--muted)}
    .token-area{margin-top:12px;display:flex;flex-direction:column;gap:8px}
    .token-row{display:flex;gap:8px}
    input.token{flex:1;padding:10px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background: rgba(0,0,0,0.35);color:var(--white);font-family:monospace}
    .btn{padding:10px 12px;border-radius:8px;border:2px solid rgba(255,255,255,0.04);background:linear-gradient(180deg, rgba(43,212,198,0.06), rgba(43,212,198,0.03));color:var(--accent);font-weight:700;cursor:pointer}
    .btn-danger{background:linear-gradient(180deg, rgba(255,91,91,0.09), rgba(255,40,40,0.03));border:2px solid rgba(255,80,80,0.12);color:var(--danger)}
    .hint{color:var(--muted);font-size:13px;margin-top:8px}
    .status{height:22px;margin-top:6px;font-size:13px}
    .denied{ color:#ff8b8b; font-weight:700; }
    @keyframes shakeX {0%{ transform: translateX(0) }20%{ transform: translateX(-8px) }40%{ transform: translateX(8px) }60%{ transform: translateX(-6px) }80%{ transform: translateX(6px) }100%{ transform: translateX(0) }}
    .shake{ animation: shakeX 0.6s ease; }
    .modal-backdrop{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.6);z-index:90}
    .modal{background:linear-gradient(180deg, rgba(0,20,18,0.96), rgba(0,10,8,0.94));padding:20px;border-radius:10px;border:2px solid rgba(0,255,200,0.06);width:min(520px,92%);box-shadow:0 30px 120px rgba(0,0,0,0.8)}
    .modal h2{margin:0 0 8px 0;color:#9ef6b6}
    .modal p{color:var(--muted);margin:0 0 12px 0}
    .modal .actions{display:flex;gap:12px;justify-content:flex-end;margin-top:12px}
    .close-x{position:absolute;right:18px;top:18px;background:transparent;border:none;color:var(--muted);font-size:18px;cursor:pointer}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <div class="brand">
        <div class="logo">A</div>
        <div>
          <h1>Admin Console</h1>
          <div class="sub">Maintenance & Operations</div>
        </div>
      </div>
      <div class="sub">Secure console — authorized personnel only</div>
    </div>

    <div class="panel">
      <h3>Admin Activities</h3>
      <div class="cards" id="cards"></div>
    </div>

    <div style="height:18px"></div>

    <div class="panel">
      <h3>Audit & Backups</h3>
      <p class="sub">Available artifacts (download for offline inspection):</p>
      <div style="margin-top:10px;display:flex;gap:8px">
        <a href="./backup_config.txt" download="backup_config.txt" style="color:var(--accent);text-decoration:none;background:rgba(255,255,255,0.02);padding:8px 10px;border-radius:6px;border:1px solid rgba(255,255,255,0.03)">Download backups</a>
        <a href="./admin_logs.txt" download="admin_logs.txt" style="color:var(--accent);text-decoration:none;background:rgba(255,255,255,0.02);padding:8px 10px;border-radius:6px;border:1px solid rgba(255,255,255,0.03)">Download logs</a>
      </div>
    </div>
  </div>

  <!-- Access modal template -->
  <template id="accessModal">
    <div class="modal-backdrop" role="dialog" aria-modal="true">
      <div class="modal">
        <button class="close-x" aria-label="Close">✕</button>
        <h2>ACCESS GRANTED</h2>
        <p>You have authenticated with elevated privileges.</p>
        <div class="actions">
          <button id="shutdownBtn" class="btn-danger">SHUTDOWN INTRUDERS</button>
          <button id="dismissBtn" class="btn">Dismiss</button>
        </div>
      </div>
    </div>
  </template>

  <script>
    (function(){
      // Preload audio for admin console actions
      const clickAudio = new Audio('/assets/sounds/click.wav');
      const wrongAudio = new Audio('/assets/sounds/wrong.wav');
      const successAudio = new Audio('/assets/sounds/success.wav');
      clickAudio.preload = 'auto'; wrongAudio.preload = 'auto'; successAudio.preload = 'auto';

      const EXPECTED_TOKEN = 'ADM1N_LEGACY_2025';
      const activities = [
        { id: 'view_backups', title: 'View Backups', desc: 'Inspect archived configuration and backup files.', allow: false },
        { id: 'restart_services', title: 'Restart Services', desc: 'Restart non-critical services on the cluster.', allow: false },
        { id: 'user_audit', title: 'User Audit', desc: 'Run an audit of recent user actions.', allow: false },
        { id: 'shutdown', title: 'Shutdown Intruders', desc: 'Force shutdown of suspicious external connections.', allow: true },
        { id: 'network_monitor', title: 'Network Monitor', desc: 'Open live network dashboards.', allow: false },
        { id: 'restore_backup', title: 'Restore From Backup', desc: 'Initiate restore from a selected backup file.', allow: false },
      ];

      const cardsEl = document.getElementById('cards');
      const tokenInput = document.createElement('input');
      const authBtn = document.createElement('button');
      const statusEl = document.createElement('div');
      const tokenArea = document.createElement('div');

      tokenArea.className = 'token-area';
      tokenInput.className = 'token';
      tokenInput.placeholder = 'Enter token';
      authBtn.className = 'btn';
      authBtn.textContent = 'Authenticate';
      statusEl.className = 'status';

      tokenArea.appendChild(tokenInput);
      const btnRow = document.createElement('div');
      btnRow.style.display = 'flex';
      btnRow.style.gap = '8px';
      btnRow.appendChild(authBtn);
      tokenArea.appendChild(btnRow);
      tokenArea.appendChild(statusEl);

      let selectedAction = null;

      activities.forEach(act => {
        const c = document.createElement('div');
        c.className = 'card';
        c.id = 'card_' + act.id;
        c.innerHTML = `<div><div class="title">${act.title}</div><div class="desc">${act.desc}</div></div><div class="cta"><div class="badge">${act.allow ? 'Requires Token' : 'Restricted'}</div></div>`;
        c.addEventListener('click', () => {
          // play click
          try { clickAudio.currentTime = 0; clickAudio.play().catch(()=>{}); } catch {}
          selectedAction = act;
          // show token area in a simple floating modal-like panel on the page (tokenArea reused)
          // remove any existing selection highlight
          document.querySelectorAll('.card').forEach(x => x.style.borderColor = 'rgba(255,255,255,0.02)');
          c.style.borderColor = 'rgba(43,212,198,0.12)';
          // insert tokenArea below the cards panel
          if (!document.body.contains(tokenArea)) {
            document.querySelector('.wrap').appendChild(tokenArea);
          }
          tokenInput.value = '';
          statusEl.textContent = '';
          tokenInput.focus();
        });
        cardsEl.appendChild(c);
      });

      function denyFeedback(cardId) {
        const card = document.getElementById('card_' + cardId);
        if (!card) return;
        statusEl.textContent = 'Access denied — token rejected.';
        statusEl.className = 'status denied';
        // play wrong sound
        try { wrongAudio.currentTime = 0; wrongAudio.play().catch(()=>{}); } catch {}
        card.classList.remove('shake');
        card.offsetWidth; // force reflow
        card.classList.add('shake');
      }

      function successFlow() {
        statusEl.textContent = 'Access granted.';
        statusEl.className = 'status';
        // play success sound
        try { successAudio.currentTime = 0; successAudio.play().catch(()=>{}); } catch {}
        const tpl = document.getElementById('accessModal');
        const frag = tpl.content.cloneNode(true);
        const backdrop = frag.querySelector('.modal-backdrop');
        const closeX = frag.querySelector('.close-x');
        const dismiss = frag.querySelector('#dismissBtn');
        const shutdown = frag.querySelector('#shutdownBtn');

        function removeModal() { if (backdrop && backdrop.parentNode) backdrop.parentNode.removeChild(backdrop); }
        closeX.addEventListener('click', () => { try { clickAudio.currentTime = 0; clickAudio.play().catch(()=>{}); } catch {}; removeModal(); });
        dismiss.addEventListener('click', () => { try { clickAudio.currentTime = 0; clickAudio.play().catch(()=>{}); } catch {}; removeModal(); });

        shutdown.addEventListener('click', () => {
          try { successAudio.currentTime = 0; successAudio.play().catch(()=>{}); } catch {}
          // small delay so the success sound can start, then show flag
          setTimeout(() => {
            alert('flag{admin_backup_leak}');
          }, 250);
        });

        document.body.appendChild(backdrop);
      }

      authBtn.addEventListener('click', () => {
        const token = tokenInput.value.trim();
        if (!selectedAction) {
          statusEl.textContent = 'No activity selected.';
          return;
        }
        // If selected action is allowed (shutdown) and token matches, success
        if (selectedAction.allow && token === EXPECTED_TOKEN) {
          successFlow();
        } else {
          denyFeedback(selectedAction.id);
        }
      });

      tokenInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          e.preventDefault();
          authBtn.click();
        }
      });

    })();
  </script>
</body>
</html>